# SDN控制器管理前端功能

## 概述

前端新增了SDN控制器管理功能，包括控制器列表页面和详情页面，支持创建、编辑、删除控制器，以及同步和查看拓扑快照。

## 新增文件

### 1. Pinia Store
- **文件**: `src/stores/controller.ts`
- **功能**: 
  - 管理控制器状态
  - 封装所有控制器相关的API调用
  - 管理快照数据

### 2. 控制器列表页面
- **文件**: `src/views/ControllerList.vue`
- **路由**: `/controllers`
- **功能**:
  - 显示所有SDN控制器列表
  - 创建新控制器（支持用户名密码或API Token认证）
  - 删除控制器
  - 测试连接
  - 跳转到控制器详情

### 3. 控制器详情页面
- **文件**: `src/views/ControllerDetail.vue`
- **路由**: `/controllers/:id`
- **功能**:
  - 显示控制器详细信息
  - 编辑控制器配置
  - 同步拓扑快照
  - 查看快照列表
  - 查看快照详情（节点列表、连接列表、JSON数据）

## 导航菜单

在顶部导航栏新增了"SDN控制器"菜单项：

```
主页 | 排障知识图谱 | SDN控制器
```

## 功能说明

### 1. 创建控制器

**步骤**:
1. 进入"SDN控制器"页面
2. 点击"添加控制器"按钮
3. 填写表单：
   - 控制器名称（必填，只能包含字母、数字、下划线、连字符）
   - 控制器类型（选择：OpenDaylight、ONOS、Floodlight、Ryu、自定义）
   - 主机地址（必填）
   - 端口（必填，1-65535）
   - 认证方式（二选一）：
     - **用户名密码**: 输入用户名和密码
     - **API令牌**: 输入API Token
4. 点击"确定"创建

**验证规则**:
- 必须提供用户名/密码或API令牌
- 控制器名称必须唯一
- Host+Port组合必须唯一

### 2. 查看控制器列表

**显示字段**:
- ID
- 名称（点击可进入详情）
- 类型（带颜色标签）
- 地址（host:port）
- 用户名
- 状态（活跃/非活跃/错误/未知）
- 创建时间

**操作按钮**:
- **测试**: 测试控制器连接
- **详情**: 进入详情页面
- **删除**: 删除控制器

### 3. 控制器详情

#### 基本信息
显示控制器的完整信息，包括：
- ID、名称、类型、状态
- 主机地址、端口、用户名
- 创建时间、更新时间

#### 操作按钮
- **测试连接**: 测试与控制器的连接
- **编辑**: 编辑控制器信息（可更新URL和认证信息）

### 4. 拓扑快照管理

#### 同步快照
- 点击"同步快照"按钮
- 系统会从控制器获取当前拓扑并保存为快照
- 快照包含节点和连接信息

#### 查看快照列表
显示所有快照记录：
- 快照ID
- 快照时间
- 节点数
- 连接数
- 创建时间

#### 查看快照详情
点击"查看"按钮打开快照详情对话框，包含4个标签页：

1. **拓扑可视化** (开发中)
   - 未来将展示拓扑图形化视图

2. **节点列表**
   - 显示所有节点
   - 节点ID、类型、属性

3. **连接列表**
   - 显示所有连接
   - 源节点、目标节点、属性

4. **JSON数据**
   - 显示完整的JSON格式快照数据

## API端点

前端使用以下API端点：

```
GET    /api/v1/sdn/controllers              # 获取控制器列表
POST   /api/v1/sdn/controllers              # 创建控制器
GET    /api/v1/sdn/controllers/:id          # 获取控制器详情
PUT    /api/v1/sdn/controllers/:id          # 更新控制器
DELETE /api/v1/sdn/controllers/:id          # 删除控制器
POST   /api/v1/sdn/controllers/:id/test     # 测试连接
GET    /api/v1/sdn/controllers/:id/topology # 获取拓扑

POST   /api/v1/sdn/controllers/:id/snapshots/sync        # 同步快照
GET    /api/v1/sdn/controllers/:id/snapshots             # 获取快照列表
GET    /api/v1/sdn/controllers/:id/snapshots/:snapshotId # 获取快照详情
DELETE /api/v1/sdn/controllers/:id/snapshots/:snapshotId # 删除快照
```

## 使用示例

### 1. 添加OpenDaylight控制器

```
1. 点击"添加控制器"
2. 填写：
   - 名称: odl-main
   - 类型: OpenDaylight
   - 主机: 192.168.1.100
   - 端口: 8181
   - 认证方式: 用户名密码
   - 用户名: admin
   - 密码: admin
3. 点击"确定"
```

### 2. 同步拓扑快照

```
1. 进入控制器详情页
2. 在"拓扑快照"部分点击"同步快照"
3. 系统自动获取当前拓扑并保存
4. 快照列表会自动刷新
```

### 3. 查看快照

```
1. 在快照列表中点击"查看"按钮
2. 查看不同标签页的数据：
   - 节点列表: 查看所有网络节点
   - 连接列表: 查看节点间的连接关系
   - JSON数据: 查看原始JSON数据
```

## 样式特点

- 使用Element Plus组件库
- 响应式布局，最大宽度1400px
- 卡片式设计，层次分明
- 彩色标签区分状态和类型
- 加载动画和错误提示

## 后续优化建议

1. **拓扑可视化**
   - 集成D3.js或其他图形库
   - 实现交互式拓扑图展示
   - 支持节点拖拽和缩放

2. **实时监控**
   - 添加控制器状态实时监控
   - 显示网络流量图表
   - 告警通知

3. **快照比较**
   - 支持两个快照的对比
   - 高亮显示拓扑变化

4. **批量操作**
   - 批量删除控制器
   - 批量同步快照

5. **导出功能**
   - 导出拓扑数据为CSV/Excel
   - 导出拓扑图为PNG/SVG

## 开发和测试

### 本地开发

```bash
cd aiops-platform-ui
npm install
npm run dev
```

### 访问页面

```
http://localhost:5173/controllers
```

### 测试流程

1. 确保后端服务正在运行
2. 确保数据库表已创建
3. 访问控制器管理页面
4. 尝试创建、编辑、删除操作
5. 测试快照同步功能

## 注意事项

1. 创建控制器时必须提供认证信息（用户名/密码或API令牌）
2. 删除控制器会同时删除所有相关快照
3. 快照数据存储在后端数据库中
4. 拓扑可视化功能需要进一步开发
